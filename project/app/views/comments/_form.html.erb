<%= form_with(model: [ @article, @article.comments.build ], local: true) do |form| %>

  <% if @comment && @comment.errors.any? %>
    <div id="error_explanation">
      <h2>
        <%= pluralize(@comment.errors.count, "error") %> prohibited
        this comment from being saved:
      </h2>
      <ul>
        <% @comment.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <p>
    <% if current_user %>
      <%= form.hidden_field :author, value: current_user.username, readonly: true if @article %>
      <%= form.text_area :text %>
      <br><%= form.submit "Post Comment" %>
    <% else %>
      Login to comment
    <% end %>
  </p>

<% end %>